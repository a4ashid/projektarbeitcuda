%share memory
\subsection{Shared Memory}
In der Grafikkate ist der Zugriff auf den globalen Speicher langsamer als auf den On-Chip-Speicher.  Wie Beispiele in \cite{cudapg} gezeigt, kann man mehrer mal verwendete Daten zunächst in shared Memory schreiben, dann für die entsprechenden Operationen benutzen. In der Multiplikation der Vollmatrize mal Vektor wird jede Vektorelement mehr mal gebraut. Nach Untersuchungen wählen wir 1-Dimensionblock,die 64 beträgt und jede Vektorelement 8 mal gebraucht in einem Block, d.h. in jedem Block 8 zerlegende Vektormultiplikation bearbeitet werden. Die Abb.\ref{sharememory}.(Vergleich von optimierte Vollmatrixmultiplikation mit C-Implementierung und alte GPU-Implementirung für $M$*$N$ Vollmatrix) zeigt die Laufzeitenunterschied von unterschiedlichen Implementierung. Die genauen Messungen stellen in Tabelle\ref{tab_shared_memory} dar. 
\begin{figure}[htbp]
%\centering
\includegraphics[width=3.5in]{../xby/pic/sharememory}
\caption{Vergleich von optimierte Vollmatrixmultiplikation mit C-Implementierung und alte GPU-Implementirung für $M$ * $N$ Vollmatrix}
\label{sharememory}
\end{figure}


%\usepackage{booktabs}
%\usepackage{tabularx}
\begin{table}
\renewcommand{\arraystretch}{1.3}
\caption{Ausführungszeiten der Vollmatrix-Vektormultipkation $ \bf{A_{mn} } \cdot \bf b$}
\label{tab_shared_memory}
%\begin{tabular}{|l|c|c|c|c|c|}
\centering
%\begin{tabular}{|p{46pt}p{28pt}p{30pt}p{28pt}p{30pt}p{30pt}|}
%\begin{tabularx}{350pt}{1xxxxx}
\begin{tabular}{|l||r|r|r|r|r|}

\hline
	$m$& $10^4$ & $10^5$ & 50000& $10^3 $ & 5000\\
    $n$& 50& 50& 50& $10^3$ & 5000 \\

\hline
\hline
CPU(ms)& 1.56&    15.94& 				80&      3.44& 87.9\\

old GPU/CPU& 1.711& 1.6348&   1.62548&  0.164&  0.12854\\

GPU/CPU & 0.133& 0.0662&     0.06204&   0.0512& 0.03438\\


\hline
\end{tabular}
%\end{tabularx}
\end{table}
Die optimierte GPU-Implementierung ist immer schnelle als die CPU-Implementierung  und die Alte. Für Matrix 5000x5000 kann die CUDA-Programm 30 mal schneller als CPU

